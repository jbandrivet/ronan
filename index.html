<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soumis Ronan le Bouffon</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: repeating-linear-gradient(
        45deg,
        #f59e0b 0,
        #f59e0b 25%,
        #3b82f6 25%,
        #3b82f6 50%,
        #10b981 50%,
        #10b981 75%,
        #ef4444 75%,
        #ef4444 100%
      );
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: #111;
    }
    .main-container {
      max-width: 900px;
      width: 100%;
    }
    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #ef4444;
    }
    h2 {
      font-size: 1.4rem;
      margin-bottom: 10px;
      color: #3b82f6;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
      justify-content: center;
    }
    .buttons button {
      flex: 1;
      min-width: 120px;
      padding: 12px;
      border-radius: 12px;
      border: 2px solid #111;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      transition: transform 0.2s;
    }
    .buttons button:hover {
      transform: scale(1.05);
    }
    .message-box {
      border: 2px dashed #111;
      background: #fef3c7;
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 20px;
      min-height: 50px;
    }
    .message-box strong {
      display: block;
      margin-bottom: 8px;
    }
    #message {
      font-size: 16px;
      font-weight: bold;
      color: #111;
    }
    .actions {
      margin-top: 20px;
    }
    .actions button {
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      display: inline-block;
      margin: 5px;
      border: 2px solid #111;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .actions button:hover {
      transform: scale(1.05);
    }
    .whatsapp-btn {
      background: #25d366;
      color: white;
    }
    .joke-button {
      background: #f59e0b;
      color: white;
    }
    input[type='text'], input[type='number'], select {
      width: 85%;
      padding: 10px;
      margin: 10px 0;
      border: 2px solid #111;
      border-radius: 8px;
      font-size: 14px;
    }
    textarea {
      width: 85%;
      height: 150px;
      padding: 10px;
      margin: 10px 0;
      border: 2px solid #111;
      border-radius: 8px;
      font-size: 14px;
      font-family: monospace;
    }
    .note {
      background: #dbeafe;
      border-left: 4px solid #3b82f6;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      text-align: left;
    }
    .note strong {
      color: #1e40af;
      display: block;
      margin-bottom: 8px;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .tab {
      padding: 10px 20px;
      background: #e5e7eb;
      border: 2px solid #111;
      color: #111;
      cursor: pointer;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      transition: all 0.2s;
    }
    .tab.active {
      background: #3b82f6;
      color: white;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .hidden {
      display: none;
    }
    .copy-group {
      display: flex;
      gap: 4px;
    }
    .copy-group input {
      flex: 1;
    }
  </style>
</head>
<body>
  <div class="main-container">
    
    <!-- ONGLETS PRINCIPAUX -->
    <div class="container" id="mainNav">
      <h1>ü§° Soumis Ronan le Bouffon ü§°</h1>
      <div class="tabs">
        <button class="tab active" onclick="switchMainTab('positions')">üì∏ Positions</button>
        <button class="tab" onclick="switchMainTab('repas')">üçΩÔ∏è Repas de Ronan</button>
      </div>
    </div>

    <!-- TAB POSITIONS -->
    <div id="positions" class="tab-content active">
      <div class="container">
        <h2>Positions de la t√™te</h2>
        <p>Choisis une position et envoie le message sur WhatsApp.</p>
        <p><strong>Ronan devra envoyer une photo de lui-m√™me dans la position souhait√©e.</strong></p>
        
        <div class="buttons">
          <button onclick="setPosition('face')" style="background:#ef4444;color:white;">Face</button>
          <button onclick="setPosition('gauche')" style="background:#3b82f6;color:white;">Gauche</button>
          <button onclick="setPosition('droite')" style="background:#10b981;color:white;">Droite</button>
          <button onclick="setPosition('arriere')" style="background:#8b5cf6;color:white;">Arri√®re</button>
          <button onclick="randomPosition()" style="background:#ec4899;color:white;">üé≤ Al√©atoire</button>
        </div>
        
        <div class="message-box">
          <strong>Message pr√©-√©crit :</strong>
          <div id="message">Met la t√™te √† face</div>
        </div>
        
        <div>
          <input type="text" id="customMessage" placeholder="√âcris un message personnalis√© pour Ronan">
        </div>
        
        <div class="actions">
          <button class="whatsapp-btn" onclick="sendWhatsApp()">üì± Envoyer sur WhatsApp</button>
          <button class="joke-button" onclick="requestJoke()">üòÇ Demander une blague</button>
        </div>
      </div>
    </div>

    <!-- TAB REPAS DE RONAN -->
    <div id="repas" class="tab-content">
      <div class="container">
        <h2>ü§¢ Les Repas de Ronan ü§¢</h2>
        
        <div class="note">
          <strong>üìù Comment √ßa marche ?</strong>
          Tu choisis un animal ou une nourriture d√©go√ªtante avec ses onomatop√©es. Le syst√®me g√©n√®re un lien que tu envoies √† Ronan sur WhatsApp. Ronan devra alors taper EXACTEMENT les onomatop√©es le nombre de fois demand√©. S'il fait UNE SEULE erreur, tout est effac√© et il recommence √† z√©ro ! üòà
        </div>

        <div class="tabs">
          <button class="tab active" onclick="switchTab('animals')">üêå Animaux</button>
          <button class="tab" onclick="switchTab('food')">üçΩÔ∏è Nourriture</button>
        </div>

        <!-- SOUS-TAB ANIMAUX -->
        <div id="animals" class="tab-content active">
          <h2 style="font-size:1.2rem;">Animaux D√©go√ªtants</h2>
          <div>
            <label for="animal"><strong>Choisir un animal :</strong></label>
            <select id="animal">
              <option value="sluuuurpp glouuuup schliiick">Limace g√©ante africaine</option>
              <option value="glop glop plouchhh schluuurrp">Ver marin perforateur de bois</option>
              <option value="bzzzchhh plip plop sliiibber">Escargot baveux des marais</option>
              <option value="squishhh gluuup gluuup frrrslip">Bigorneau visqueux</option>
              <option value="schluuurp slibber plop schlick">Patelle gluante</option>
              <option value="gloupsss plock blop blop">Bulot des fonds vaseux</option>
              <option value="sllluuurrrrp chchch slibber glop">Moule verte invasive</option>
              <option value="slip glchhh plopf schrrlick">Coquille Saint-Jacques</option>
              <option value="plip schluuuup glibber slorrrrp">Liguie</option>
              <option value="glibb sluuuurp schlick plop">Escargot de mer blanc</option>
              <option value="crrrack pffshhh slibber glop">Mille-pattes g√©ant africain</option>
              <option value="schrrrk glup glup plip plop">Scolopendre venimeuse</option>
              <option value="plock chhh slibber glop">Cloporte g√©ant</option>
              <option value="squishhh blop glurrrrp">Punaise d'eau g√©ante</option>
              <option value="crunchhh glup frrt schluurrp">Crabe araign√©e g√©ant</option>
              <option value="plop schrrp glibber fliiick">Crabe violoniste</option>
              <option value="slup glib plop schluup">Crevette fant√¥me</option>
              <option value="glub schhh plop slorrrrp">Larve de crabes ou homards</option>
              <option value="squishhh glop blop plip">Tique gorg√©e de sang</option>
              <option value="crlch sluuuurp blop frrrslip">√âcrevisse am√©ricaine</option>
            </select>
          </div>

          <div>
            <label for="countAnimal"><strong>Nombre de r√©p√©titions :</strong></label>
            <input type="number" id="countAnimal" min="1" max="50" value="5">
          </div>

          <div class="actions">
            <button id="generateAnimal" style="background:#f59e0b;color:white;">G√©n√©rer le d√©fi</button>
          </div>

          <div id="challengeAnimal" style="display:none; margin-top:20px;">
            <div class="message-box" style="background:#fef3c7;">
              <p><strong>Lien du d√©fi g√©n√©r√© :</strong></p>
              <div class="copy-group">
                <input type="text" id="linkAnimal" readonly style="margin-top:8px;">
                <button onclick="copyLinkAnimal()">Copier</button>
              </div>
            </div>
            <div class="actions">
              <button onclick="shareAnimalWhatsApp()" style="background:#25d366;color:white;">üì± Envoyer sur WhatsApp</button>
            </div>
          </div>
        </div>

        <!-- SOUS-TAB NOURRITURE -->
        <div id="food" class="tab-content">
          <h2 style="font-size:1.2rem;">Nourritures D√©go√ªtantes</h2>
          <div>
            <label for="foodItem"><strong>Choisir une nourriture :</strong></label>
            <select id="foodItem">
              <option value="miam slurrrrp crunch glop">≈íufs de cent ans pourris</option>
              <option value="gloub schluup beurk plop">Fromage au lait cru moisi</option>
              <option value="squishhh munch glurrp slibber">Haggis √©cossais baveux</option>
              <option value="schlop gloup miam crrrunch">Durian ferment√© puant</option>
              <option value="slurp glibb crunch beurkkk">Natt≈ç japonais gluant</option>
              <option value="plop munch schliiick gloup">Casu marzu italien grouillant</option>
              <option value="gloop sliiibber miam crunch">Surstr√∂mming su√©dois pourri</option>
              <option value="crunch sluuurp beurk glibber">Balut philippin croquant</option>
              <option value="glibb plop munch schluup">Escamoles mexicaines visqueuses</option>
              <option value="schlurp crunch glop beurkkk">H√°karl islandais ammoniaqu√©</option>
              <option value="miam gloop slibber crrrack">Sannakji cor√©en vivant</option>
              <option value="glup crunch beurk squishhh">Witchetty grubs australiennes</option>
              <option value="schlick miam plop gluuup">Fugu japonais mortel</option>
              <option value="crunch glibb slurp beurk">Stinkheads alaskiens ferment√©s</option>
              <option value="glop munch schliiick plop">Lutefisk norv√©gien g√©latineux</option>
              <option value="sluuurp crrrack beurkkk glibber">Tarentule frite cambodgienne</option>
              <option value="miam schlop gloup crunch">Cervelle de singe crue</option>
              <option value="glibb plop slurrp beurk">T√™te de mouton bouillie</option>
              <option value="crunch gloop miam schluup">Grillons frits croustillants</option>
              <option value="schlick glop beurkkk slibber">Soupe de sang coagul√©</option>
            </select>
          </div>

          <div>
            <label for="countFood"><strong>Nombre de r√©p√©titions :</strong></label>
            <input type="number" id="countFood" min="1" max="50" value="5">
          </div>

          <div class="actions">
            <button id="generateFood" style="background:#f59e0b;color:white;">G√©n√©rer le d√©fi</button>
          </div>

          <div id="challengeFood" style="display:none; margin-top:20px;">
            <div class="message-box" style="background:#fef3c7;">
              <p><strong>Lien du d√©fi g√©n√©r√© :</strong></p>
              <div class="copy-group">
                <input type="text" id="linkFood" readonly style="margin-top:8px;">
                <button onclick="copyLinkFood()">Copier</button>
              </div>
            </div>
            <div class="actions">
              <button onclick="shareFoodWhatsApp()" style="background:#25d366;color:white;">üì± Envoyer sur WhatsApp</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MODE D√âFI (quand Ronan clique sur le lien) -->
    <div id="challengeMode" class="hidden">
      <div class="container">
        <h1 id="challengeTitle">ü§° D√©fi de Ronan ü§°</h1>
        <div class="message-box">
          <p style="font-weight:bold;margin-bottom:8px;">Tape cette phrase <span id="challengeReps"></span> fois :</p>
          <p style="font-size:1.3rem;color:#ef4444;font-weight:bold;margin:10px 0;" id="challengePhrase"></p>
          <p style="color:#666;font-size:0.9rem;">‚ö†Ô∏è Une seule erreur = tout recommence √† z√©ro !</p>
        </div>
        
        <div style="margin:20px 0;">
          <p style="font-weight:bold;margin-bottom:8px;">Progression : <span id="challengeProgress">0 / 0</span></p>
        </div>
        
        <textarea id="challengeInput" placeholder="Commence √† taper ici..." style="height:120px;"></textarea>
        
        <p id="challengeError" style="color:red;font-weight:bold;margin-top:10px;"></p>
        <p id="challengeSuccess" style="color:green;font-weight:bold;margin-top:10px;"></p>
      </div>
    </div>

  </div>

  <script>
    const TARGET_WHATSAPP_NUMBER = "33781937228";
    let position = "face";
    const randomVariations = [
      "arri√®re profil gauche",
      "arri√®re profil droit",
      "arri√®re tourne ta t√™te √† gauche",
      "arri√®re tourne ta t√™te √† droite",
      "arri√®re tourne ta t√™te face",
      "arri√®re simple"
    ];

    // √âtat du d√©fi
    let challengeState = {
      phrase: '',
      reps: 0,
      completed: 0
    };

    // SWITCH ONGLET PRINCIPAL
    function switchMainTab(tab) {
      document.querySelectorAll('#mainNav .tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.main-container > .tab-content').forEach(c => c.classList.remove('active'));
      
      if(tab === 'positions') {
        document.querySelector('#mainNav .tab:nth-child(1)').classList.add('active');
        document.getElementById('positions').classList.add('active');
      } else {
        document.querySelector('#mainNav .tab:nth-child(2)').classList.add('active');
        document.getElementById('repas').classList.add('active');
      }
    }

    // SWITCH SOUS-ONGLET REPAS
    function switchTab(tab) {
      document.querySelectorAll('#repas .tabs .tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('#repas > .container > .tab-content').forEach(c => c.classList.remove('active'));
      
      if(tab === 'animals') {
        document.querySelector('#repas .tabs .tab:nth-child(1)').classList.add('active');
        document.getElementById('animals').classList.add('active');
      } else {
        document.querySelector('#repas .tabs .tab:nth-child(2)').classList.add('active');
        document.getElementById('food').classList.add('active');
      }
    }

    // POSITIONS
    function messageFor(pos) {
      return `Met la t√™te √† ${pos}`;
    }

    function setPosition(pos) {
      position = pos;
      document.getElementById("message").innerText = messageFor(pos);
    }

    function randomPosition() {
      const randomPos = randomVariations[Math.floor(Math.random() * randomVariations.length)];
      position = randomPos;
      document.getElementById("message").innerText = `Met la t√™te √† ${randomPos}`;
      alert("üé≤ Position al√©atoire choisie : " + randomPos + " !");
    }

    function sendWhatsApp() {
      let customText = document.getElementById('customMessage').value;
      let textToSend = customText ? encodeURIComponent(customText) : encodeURIComponent(messageFor(position));
      window.open(`https://api.whatsapp.com/send?phone=${TARGET_WHATSAPP_NUMBER}&text=${textToSend}`, '_blank');
    }

    function requestJoke() {
      const jokeMessage = encodeURIComponent("Salut Ronan, raconte-moi une blague ! ü§°");
      window.open(`https://api.whatsapp.com/send?phone=${TARGET_WHATSAPP_NUMBER}&text=${jokeMessage}`, '_blank');
    }

    // G√âN√âRATION ANIMAUX
    document.getElementById("generateAnimal").addEventListener("click", function() {
      const animal = document.getElementById("animal").value;
      const animalName = document.getElementById("animal").selectedOptions[0].text;
      const count = parseInt(document.getElementById("countAnimal").value);
      
      const challengeData = { phrase: animal, reps: count, name: animalName };
      const encoded = btoa(JSON.stringify(challengeData));
      const link = `${window.location.origin}${window.location.pathname}?challenge=${encoded}`;
      
      document.getElementById("linkAnimal").value = link;
      document.getElementById("challengeAnimal").style.display = "block";
    });

    function copyLinkAnimal() {
      const link = document.getElementById("linkAnimal").value;
      navigator.clipboard.writeText(link);
      alert("‚úÖ Lien copi√© !");
    }

    function shareAnimalWhatsApp() {
      const link = document.getElementById("linkAnimal").value;
      const animal = document.getElementById("animal").value;
      const animalName = document.getElementById("animal").selectedOptions[0].text;
      const count = document.getElementById("countAnimal").value;
      const message = `ü§° REPAS DE RONAN ü§°\n\nüêå Animal: ${animalName}\nüìù R√©p√©titions: ${count}√ó\n\nüéØ Onomatop√©es √† recopier:\n"${animal}"\n\nClique sur le lien et tape EXACTEMENT cette phrase ${count} fois (une erreur = tout recommence √† z√©ro!) :\n\n${link}`;
      window.open(`https://api.whatsapp.com/send?phone=${TARGET_WHATSAPP_NUMBER}&text=${encodeURIComponent(message)}`, '_blank');
    }

    // G√âN√âRATION NOURRITURE
    document.getElementById("generateFood").addEventListener("click", function() {
      const food = document.getElementById("foodItem").value;
      const foodName = document.getElementById("foodItem").selectedOptions[0].text;
      const count = parseInt(document.getElementById("countFood").value);
      
      const challengeData = { phrase: food, reps: count, name: foodName };
      const encoded = btoa(JSON.stringify(challengeData));
      const link = `${window.location.origin}${window.location.pathname}?challenge=${encoded}`;
      
      document.getElementById("linkFood").value = link;
      document.getElementById("challengeFood").style.display = "block";
    });

    function copyLinkFood() {
      const link = document.getElementById("linkFood").value;
      navigator.clipboard.writeText(link);
      alert("‚úÖ Lien copi√© !");
    }

    function shareFoodWhatsApp() {
      const link = document.getElementById("linkFood").value;
      const food = document.getElementById("foodItem").value;
      const foodName = document.getElementById("foodItem").selectedOptions[0].text;
      const count = document.getElementById("countFood").value;
      const message = `ü§° REPAS DE RONAN ü§°\n\nüçΩÔ∏è Nourriture: ${foodName}\nüìù R√©p√©titions: ${count}√ó\n\nüéØ Onomatop√©es √† recopier:\n"${food}"\n\nClique sur le lien et tape EXACTEMENT cette phrase ${count} fois (une erreur = tout recommence √† z√©ro!) :\n\n${link}`;
      window.open(`https://api.whatsapp.com/send?phone=${TARGET_WHATSAPP_NUMBER}&text=${encodeURIComponent(message)}`, '_blank');
    }

    // MODE D√âFI - Gestion de la saisie
    const challengeInput = document.getElementById('challengeInput');
    if (challengeInput) {
      challengeInput.addEventListener('input', function() {
        const trimmed = this.value.trim();
        const error = document.getElementById('challengeError');
        const success = document.getElementById('challengeSuccess');
        
        if (trimmed === challengeState.phrase) {
          challengeState.completed++;
          this.value = '';
          error.textContent = '';
          
          document.getElementById('challengeProgress').textContent = `${challengeState.completed} / ${challengeState.reps}`;
          
          if (challengeState.completed === challengeState.reps) {
            success.textContent = "üéâ Bravo Ronan, d√©fi r√©ussi ! üéâ";
            this.disabled = true;
            this.style.background = '#d1fae5';
          }
        } else if (trimmed.length > 0 && !challengeState.phrase.startsWith(trimmed)) {
          error.textContent = "‚ùå Mauvaise frappe ! Tout recommence √† z√©ro !";
          this.value = '';
          challengeState.completed = 0;
          document.getElementById('challengeProgress').textContent = `0 / ${challengeState.reps}`;
          setTimeout(() => { error.textContent = ''; }, 2000);
        }
      });

      challengeInput.addEventListener('paste', function(e) {
        e.preventDefault();
        document.getElementById('challengeError').textContent = "‚ùå Copier-coller interdit ! Tu dois taper toi-m√™me !";
        setTimeout(() => { document.getElementById('challengeError').textContent = ''; }, 3000);
      });
    }

    // CHARGEMENT DU D√âFI
    window.addEventListener('load', function() {
      const params = new URLSearchParams(window.location.search);
      const challenge = params.get('challenge');

      if (challenge) {
        try {
          const data = JSON.parse(atob(challenge));
          challengeState.phrase = data.phrase;
          challengeState.reps = data.reps;
          challengeState.completed = 0;

          document.getElementById('mainNav').classList.add('hidden');
          document.getElementById('positions').classList.add('hidden');
          document.getElementById('repas').classList.add('hidden');
          document.getElementById('challengeMode').classList.remove('hidden');

          document.getElementById('challengeTitle').textContent = `ü§° D√©fi de Ronan : ${data.name} ü§°`;
          document.getElementById('challengePhrase').textContent = data.phrase;
          document.getElementById('challengeReps').textContent = data.reps;
          document.getElementById('challengeProgress').textContent = `0 / ${data.reps}`;

          document.getElementById('challengeInput').focus();
        } catch (err) {
          console.error('Erreur en chargeant le d√©fi', err);
        }
      }
    });
  </script>
</body>
</html>

